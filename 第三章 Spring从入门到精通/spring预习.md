# 课堂主题

###### Spring IoC和AOP的应用、事务支持

课堂目标

搞明白什么是IoC、什么是DI、什么是AOP、什么是Spring容器掌握Spring IoC/DI基于XML方式的应用

掌握Spring IoC/DI基于XML和注解混合的使用掌握Spring IoC/DI基于纯注解的使用

掌握Spring基于AspectJ的AOP使用之XML方式

掌握Spring基于AspectJ的AOP使用之ML和注解混合方式掌握Spring基于AspectJ的AOP使用之纯注解方式的应用掌握Spring声明式事务的使用之XML方式

掌握Spring声明式事务的使用之XML和注解混合方式掌握Spring声明式事务的使用之纯注解方式的应用

知识要点

[课堂主题](https://wordhtml.com/#_bookmark2)[课堂目标](https://wordhtml.com/#_bookmark1)[知识要点](https://wordhtml.com/#_bookmark0)[介绍篇](https://wordhtml.com/#_bookmark5)

[什么是Spring](https://wordhtml.com/#_bookmark4)

[为什么学习Spring](https://wordhtml.com/#_bookmark3) [什么是耦合和内聚](https://wordhtml.com/#_bookmark6)[Spring版本介绍](https://wordhtml.com/#_bookmark7) [Spring体系结构](https://wordhtml.com/#_bookmark8) [Spring核心概念介绍](https://wordhtml.com/#_bookmark13)

[核心基础篇](https://wordhtml.com/#_bookmark12)

[基于XML的使用](https://wordhtml.com/#_bookmark11)[IoC配置](https://wordhtml.com/#_bookmark10)

[bean标签介绍](https://wordhtml.com/#_bookmark9)

[bean实例化的三种方式](https://wordhtml.com/#_bookmark14)[DI配置](https://wordhtml.com/#_bookmark16)

[概述](https://wordhtml.com/#_bookmark15)

[依赖注入的方式](https://wordhtml.com/#_bookmark18)[构造函数注入](https://wordhtml.com/#_bookmark17)

[set方法注入（重点）](https://wordhtml.com/#_bookmark20) [使用p名称空间注入数据](https://wordhtml.com/#_bookmark19)

[依赖注入不同类型的属性](https://wordhtml.com/#_bookmark24)[简单类型（value）](https://wordhtml.com/#_bookmark23)[引用类型（ref）](https://wordhtml.com/#_bookmark22) [集合类型（数组）](https://wordhtml.com/#_bookmark21)

[基于注解和XML混合方式的使用](https://wordhtml.com/#_bookmark26)

[IoC注解使用方法](https://wordhtml.com/#_bookmark25)[常用注解](https://wordhtml.com/#_bookmark32)

[IoC注解（创建对象）](https://wordhtml.com/#_bookmark31) [Component注解](https://wordhtml.com/#_bookmark30)

[Controller&Service&Repository注解](https://wordhtml.com/#_bookmark29) [DI注解（依赖注入）](https://wordhtml.com/#_bookmark28)

[@Autowired](https://wordhtml.com/#_bookmark27) [@Qualifier](https://wordhtml.com/#_bookmark38) [@Resource](https://wordhtml.com/#_bookmark37) [@Inject](https://wordhtml.com/#_bookmark36) [@Value](https://wordhtml.com/#_bookmark35)

[@Autowired、@Resource、@Inject区别](https://wordhtml.com/#_bookmark34)[改变Bean作用范围的注解](https://wordhtml.com/#_bookmark33)

[生命周期相关注解](https://wordhtml.com/#_bookmark40)[关于注解和XML的选择问题](https://wordhtml.com/#_bookmark39)

[基于纯注解方式的使用](https://wordhtml.com/#_bookmark41)

[注解和XML混合开发遗留的问题](https://wordhtml.com/#_bookmark42)[@Configuration](https://wordhtml.com/#_bookmark44)

[@Bean](https://wordhtml.com/#_bookmark43) [@ComponentScan](https://wordhtml.com/#_bookmark45) [@PropertySource](https://wordhtml.com/#_bookmark46) [@Import](https://wordhtml.com/#_bookmark47)

[创建纯注解方式上下文容器](https://wordhtml.com/#_bookmark50)

[核心高级篇](https://wordhtml.com/#_bookmark49)

[AOP介绍](https://wordhtml.com/#_bookmark48)

[什么是AOP](https://wordhtml.com/#_bookmark52)

[为什么使用AOP](https://wordhtml.com/#_bookmark51) [AOP相关术语介绍](https://wordhtml.com/#_bookmark54)

[术语解释](https://wordhtml.com/#_bookmark53)[图示说明](https://wordhtml.com/#_bookmark56)

[AOP实现之AspectJ（了解）](https://wordhtml.com/#_bookmark55) [AOP实现之Spring AOP(了解)](https://wordhtml.com/#_bookmark59)

[实现原理分析](https://wordhtml.com/#_bookmark58)

[JDK动态代理](https://wordhtml.com/#_bookmark57)[Cglib动态代理](https://wordhtml.com/#_bookmark60)

[使用](https://wordhtml.com/#_bookmark64)

[基于AspectJ的AOP使用](https://wordhtml.com/#_bookmark63)[添加依赖](https://wordhtml.com/#_bookmark62)

[编写目标类和目标方法](https://wordhtml.com/#_bookmark61)[使用XML实现](https://wordhtml.com/#_bookmark67)

[实现步骤](https://wordhtml.com/#_bookmark66)

[切入点表达式](https://wordhtml.com/#_bookmark65)[通知类型](https://wordhtml.com/#_bookmark68)

[使用注解实现](https://wordhtml.com/#_bookmark70)

[实现步骤](https://wordhtml.com/#_bookmark69)

[环绕通知注解配置](https://wordhtml.com/#_bookmark71)[定义通用切入点](https://wordhtml.com/#_bookmark72)

[纯注解方式](https://wordhtml.com/#_bookmark77)

[组件支撑篇](https://wordhtml.com/#_bookmark76)

[整合Junit](https://wordhtml.com/#_bookmark75)

[单元测试问题](https://wordhtml.com/#_bookmark74)[解决思路分析](https://wordhtml.com/#_bookmark73)[具体实现](https://wordhtml.com/#_bookmark81)

[事务支持](https://wordhtml.com/#_bookmark80)

[事务回顾](https://wordhtml.com/#_bookmark79)

[事务介绍](https://wordhtml.com/#_bookmark78)

[事务并发问题（隔离性导致）](https://wordhtml.com/#_bookmark83) [事务隔离级别](https://wordhtml.com/#_bookmark82)

[Spring框架事务管理相关接口](https://wordhtml.com/#_bookmark84) [Spring框架事务管理的分类](https://wordhtml.com/#_bookmark86)

[编程式事务管理（了解）](https://wordhtml.com/#_bookmark85) [声明式事务管理（重点）](https://wordhtml.com/#_bookmark87)

[事务管理之XML方式](https://wordhtml.com/#_bookmark92)[业务层](https://wordhtml.com/#_bookmark91)

[持久层](https://wordhtml.com/#_bookmark90)[spring配置](https://wordhtml.com/#_bookmark89)[单元测试代码](https://wordhtml.com/#_bookmark88)

[配置事务管理的AOP](https://wordhtml.com/#_bookmark93) [事务管理之混合方式](https://wordhtml.com/#_bookmark95)

[事务管理之基于AspectJ的纯注解方式](https://wordhtml.com/#_bookmark94)

# 介绍篇

什么是Spring

###### 百度百科中的介绍

Spring官方网址：http://spring.io/

我们经常说的Spring其实指的是Spring Framework （spring 框架）。

为什么学习Spring

好处：

什么是耦合和内聚

###### 耦合性(Coupling)，也叫耦合度，是对模块间关联程度的度量。

1 在软件工程中，耦合指的就是就是对象之间的依赖性。对象之间的耦合越高，维护成本越高。因此对象的设计应使类和 构件之间的耦合最小。

2

3 软件设计中通常用耦合度和内聚度作为衡量模块独立程度的标准。

4

5 划分模块的一个准则就是高内聚低耦合。

###### 内聚标志一个模块内各个元素彼此结合的紧密程度，它是信息隐蔽和局部化概念的自然扩展。

Spring版本介绍

spring的官网：http://spring.io/

spring framework的网址：https://projects.spring.io/spring-framework/

jar包下载地址：http://repo.spring.io/release/org/springframework/spring/

Spring体系结构

Spring核心概念介绍

IoC（核心中的核心）：Inverse of Control，控制反转。对象的创建权力由程序反转给Spring框架。DI：Dependency Injection，依赖注入。在Spring框架负责创建Bean对象时，动态的将依赖对象注入到Bean组件中！！

AOP：Aspect Oriented Programming，面向切面编程。在不修改目标对象的源代码情况下，增强IoC容器中Bean的功能。

Spring容器：指的就是IoC容器，底层也就是一个BeanFactory。

# 核心基础篇

基于XML的使用

IoC配置

###### 在Spring 的XML文件中通过一个bean标签，完成IoC的配置。

bean标签介绍

bean标签作用：

###### 用于配置被spring容器管理的bean的信息。

默认情况下它调用的是类中的【无参构造函数】。如果没有无参构造则不能创建成功。

bean标签属性：

###### id：给对象在容器中提供一个唯一标识。用于获取对象。 class：指定类的全限定名。用于反射创建对象。默认情况下调用无参构造函数。init-method：指定类中的初始化方法名称。

destroy-method：指定类中销毁方法名称。比如DataSource的配置中一般需要指定destroy- method=“close”。

scope：指定对象的作用范围。

singleton :默认值，单例的（在整个容器中只有一个对象）,生命周期如下： 对象出生：当应用加载，创建容器时，对象就被创建了。

对象活着：只要容器在，对象一直活着。

对象死亡：当应用卸载，销毁容器时，对象就被销毁了。

prototype :多例的.每次访问对象时，都会重新创建对象实例。生命周期如下：

对象出生：当使用对象时，创建新的对象实例。对象活着：只要对象在使用中，就一直活着。

对象死亡：当对象长时间不用时，被 java 的垃圾回收器回收了。request :将Spring 创建的 Bean 对象存入到 request 域中.

session :将Spring 创建的 Bean 对象存入到 session 域中.

global session :WEB 项目中,应用在 Portlet 环境.如果没有 Portlet 环境那么globalSession 相当于 session.

bean实例化的三种方式

第一种：使用默认无参构造函数（重点）

###### 在默认情况下：它会根据默认无参构造函数来创建类对象。如果 bean 中没有默认无参构造函数，将会创建失败。

' src="data:image/png;base64,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" v:shapes="_x0000_s1704">

第二种：静态工厂（了解）

使用 StaticFactory 类中的静态方法 createUserService 创建对象，并存入spring 容器：

1 /**

2 * 模拟一个静态工厂，创建业务层实现类

3 */

- public class StaticFactory {
  - public static UserService createUserService(){
    - return new UserServiceImpl(); 7 }

8 }

9

###### 配置说明：

第三种：实例工厂（了解）

美美 小风 ' src="data:image/png;base64,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" v:shapes="_x0000_s1728">

1. 如果是Set集合，注入的配置文件方式如下：

- \* * * 哈哈 * 呵呵 *
- 

###### 3. 如果是Map集合，注入的配置方式如下：

- \* * * * *
- 

1. 如果是Properties集合的方式，注入的配置如下：

root123 ' src="data:image/png;base64,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" v:shapes="_x0000_s1730">

基于注解和XML混合方式的使用

IoC注解使用方法

###### 第一步：spring配置文件中，配置context:component-scan标签

第二步：类上面加上注解@Component，或者它的衍生注解@Controller、@Service、@Repository

常用注解

IoC注解（创建对象）

相当于：

' src="data:image/png;base64,R0lGODlhPwMsAHcAMSH+GlNvZnR3YXJlOiBNaWNyb3NvZnQgT2ZmaWNlACH5BAEAAAAALA4AEgCsAAgAhgAAAA0LCggKDQ0LCwQIDQ0NEA4LDQsLDQoLDQ4LCgMGNA0LNA0LVwAEVw0KdgADdgMGdgAEdgoKdgAEkw0IkwAAkwQAkwMAkwQAsQsGsQAAsQQAzAAAzAoEzAMAzAgDzBAhDRA0CA0hCBA0DQ00BBQhLQ0oWg5GAxBGCxFXCg5XABBXABFXCBB3AxB3ABF3ABBnABFnCBF3BBB3BBF3Ay0OEC0LDi0hFDMzMypZhEMLDUkQEUNvmWMQEXwNDW9CDW9ZWpMODpmZb4SZb5mZmaoQEKoQDgECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwf/gACCg4SFhoeCAS0giI2OhwwbCoYMGAKNNUU2PUGCmZudj4ORHByToqiGn5yemqyNPEI6qY+KjLS4j5WXiDVGADuhvsChuB2nuajDwZ6/zIc5REBDs8mEJyiKIS4vKYIDMC/dgifiLygA2tzohw4epQSD7hwTlo0FnTs+gvjA+4gLPpTiEE/QsUEZBp5KCE8QQ4KO+unjl28ftkMmqFkjdy6dixgGRCwCoAIduBGESMgwEOCjAZUGGgUsGCkeBQ2XSuDYufPGRoMPDhg6WIhCBQQMLCAglHQpIZ08cfhMVY7doIzVclUdZAsAuGzczKFrKW5lVxEzYgL8UNDo0l0/qRHVPEQUACkORwF04NCA0N6+cQttFYQ1GQlxVruebImSqwuUaFmOjCyTrSC3du1B5TnV2tyhp+Y6uOAUQEJkpk0J2twz1+EXjQtv3MoYAAkajFSA5DoS5tm0lQu6i5cBZ2C6QUELgot5EAXAzqH/LOdNUDQi2In8mJ5txgpxjcGJBVDuBQsYMhJMBr62YGoOEOwdLxRQ4aC6DCN8qCDhHd6l8/wX2EWEBAIAOw==" v:shapes="_x0000_s1732">

Component注解

作用：

属性：

Controller&Service&Repository注解

他们三个注解都是针对@Component的衍生注解，他们的作用及属性都是一模一样的。他们只不过是提供了更加明确的语义化。

注意：如果注解中有且只有一个属性要赋值时，且名称是 value，value 在赋值时可以不写。

DI注解（依赖注入）

相当于：

2 ' src="data:image/png;base64,R0lGODlhPwNBAHcAMSH+GlNvZnR3YXJlOiBNaWNyb3NvZnQgT2ZmaWNlACH5BAEAAAAALA4AEwDXACEAhgAAAAQIDQ0LCgoLDQ4LCg0LCw4LDQ0NEAgKDQsLDQ4LCwMGNA0LNA0LKgoLNA0LVwAEVwoLVwMEVwgIdgMGdgADdg0KdgAEdgQAkw0IkwAAkwMAkwgDkwQAsQsGsQAAsQgGsQgDsQoEzAAAzAMAzAQAzAgDzBAhDQ00BBA0DQ0hCBQhLQ0oWg5GAxBGCxBGBBFXCg5XABBXChB3AxF3ABB3BBB3ABBnABF3BBFnCBF3AxBnAy0OEC0LDioLDS0hFCooDTMzMypZhEMLDUkQEVooDUNvmWMQEXwNDW9CDW9ZWpMODoRZKplvQ5mEWpmZb4SZb5mZmZmZhKoQEKoQDgECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwf/gACCg4SFhoeIiYqLjI2Oj4s8Uz1HS4KSlJaQhyIjngGJmJWXk6ObhkZPQ6esrYsCMyeus4w8VABEmra4mq4PGAO1t7mXw72sQlFKUKuzLS6wLzQ0MAACNQQ21IIo0zQp1jPS2wAFN9PV19nbMd40OAbmLoMoOQaGDx0TJCMLgh6e+gHwQKEEBICgGJjwBEHRAUtEkAh6iEvioV8RSoxoCEAhQ48BPyBIRDHiRIgSn7liwcxVCxrzBNiopiKWTHgqZABQYQMcCh0nZNKMBSDGPHMpbhrIKQiWrEEqatwrsONpoQclKiTIoCHYIK4DPGjIuMCDPxH+FIJaEaRt2x++/0p0tSBBENqOJkD98gqArdsgcB+9nHeKZbNNgwc5LXcDmlRC9abeSEpUnkx3ju8RWkzIKAAU1S52GGlhQzCsnrqa3btaY0B/tK4CI4T6NYC9sQklhmT4VDeYiitPvqaZmz3GlGUhlQlO8ePNRAlFVVAVUT7SprGCKh12AWvvJUAR8us2MCvcg7TL5kv+re9pzR31bpWY+WegxKX3vB90/09ZMRzX1HPBWTVIDDuEJhp2A1wHAFirAWMWACJoldtFsxFSYQK0ZRjbSwo6kkwUJEaRhEvQzHDON9YQyI034MCyYnPmeJOZIe28U1xNBl41GgDcDeTJBSZoAIJ3Eqa1kP8nsF14m4eCgCQQerSo5KQrnEGSZW6eXenll2CGqciWjpDpSjsCiqnmmmy26eabcMYp55x01mnnnXjmqeeefPbp55+ABirooIQWauihiCaq6KKMNuroo5BGKumklFZq6aWYZqrpppx26umnoIYq6qiklgqpKLqUcswptTU5C6qkZJKIESRKUcSiZua5CzEA7LpqK3fF5msxvCDSABCCCOGEDyhGg06L64T2G4vOklPjNupoU02O08AjDz1ppqcPP7ABxORABR00QkJLcoRISRbBi4gHFg7kj7kCDRKsg0HixRBJKJ1UEQBWHiJEE/QBJ9RONtmAk048+YTfTAwDeNSpcA4vpVM4BkY1VXX4ZLVVV4RAOFYJZZ2l5Fp/AebLjwxwwNeDJNsFG7+m2YxXAO257MhuhCjLLGLANSXcjeBKlhxj0GhjY37Q9egZaNb9GGRtqiHZXW3neilCQxlwhDVf+1qdM9f5OlM0AEYwwcpvhHGMHNTGKb3Ycvs5V5zRPU4HMj5mNxgekKZFuPXg47VsHiulORDCSOr1S+HNgd+GuCA9L97IbykEAgA7" v:shapes="_x0000_s1736">

@Autowired

@Autowired 默 认 按 类 型 装 配 （byType）， @Autowired是由AutowiredAnnotationBeanPostProcessor类实现@Autowired是spring自带的注解

@Autowired默认情况下要求依赖对象必须存在，如果需要允许null值，可以设置它的required属性为false，如：@Autowired(required=false)

如果我们想按名称装配（byName）可以结合@Qualifier 注解进行使用

@Qualifier

在自动按照类型注入的基础之上，再按照 Bean 的 id 注入。它在给字段注入时不能独立使用，必须和@Autowire 一起使用； 但是给方法参数注入时，可以独立使用。

@Resource

@Resource默认按名称装配（byName），可以通过@Resource的name属性指定名称，如果没有指定name属性， 当注解写在字段上时，默认取字段名进行按照名称查找，当找不到与名称匹配的bean时才按照类型进行装配。@Resource属于J2EE JSR250规范的实现

但是需要注意的是，如果name属性一旦指定，就只会按照名称进行装配。

推荐使用@Resource注解，因为它是属于J2EE的，减少了与spring的耦合。这样代码看起就比较优雅。

@Inject

@Inject是根据类型进行自动装配的，如果需要按名称进行装配，则需要配合@Named； @Inject是JSR330中的规范，需要导入javax.inject.Inject;实现注入。 @Inject可以作用在变量、setter方法、构造函数上。

@Value

给基本类型和String类型注入值

###### 可以使用占位符获取属性文件中的值。

@Autowired、@Resource、@Inject区别

1. @Autowired是spring自带的，@Inject是JSR330规范实现的，@Resource是JSR250规范实现的，需要导入不同的包
   1. @Autowired、@Inject用法基本一样，不同的是@Autowired有一个request属性
   2. @Autowired、@Inject是默认按照类型匹配的，@Resource是按照名称匹配的
   3. @Autowired如果需要按照名称匹配需要和@Qualifier一起使用，@Inject和@Name一起使用

改变Bean作用范围的注解

###### @Scope：指定 bean 的作用范围，相当于下面的配置：

' src="data:image/png;base64,R0lGODlhPwMsAHcAMSH+GlNvZnR3YXJlOiBNaWNyb3NvZnQgT2ZmaWNlACH5BAEAAAAALA4AEgDsAAoAhgAAAA0LCggKDQ0LCwQIDQ0NEA4LDQsLDQoLDQ4LCgMGNA0LNA0LVwAEVw0KdgADdgMGdgAEdgoKdgAEkw0IkwgGkwAAkwQAkwMAkwQAsQsGsQAAsQMAsQQAzAAAzAoEzAMAzAgDzAMDzBAhDRA0CA0hCBA0DQ00BBQhLQ0oWg5GAxBGCxFXCg5XABBXABFXCBB3AxB3ABF3ABBnABFnCBF3BBB3BBF3Ay0OEC0LDi0hFDMzMypZhEMLDUkQEUNvmWMQEXwNDW9CDW9ZWpMODpmZb4SZb5mZmaoQEKoQDgECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwf/gACCg4SFhoeCATAjiI2OhwwdCoYMGQKNOEg5QESCmZudj4ORHh6ToqiGn5yemqypsLGqrqGroYg/RT2yiIqMvMCFlZeIOEkAPrXHybwfp8GOxsjK09DWmMvUzIc8R0NGu9YqK4okMTIsggMzMuiCKu0yKwDl5/OHDiClBIP5HhOWGhXo5COIoIHIDCJaEKKUB36CnBHS4PAUxX2CLj4USFAhwoKNNEJk6JAfhZKCKlUo1UAQSQ8tEX302BHAuEMpwEGDNy9ADBoGSiwC0GLeOhOETtQw4BOoUgONGEKMZHLDJRQ7smbVYe3DgwOGJBqiYAEBgwsICJ1NOwir1h1c/4OtLeQVrKB8VS9FaumAwyWJUt1qjYuKZ6Gc4WQZTjR0Hblz8XpCXuoLQAkbUBeGgEg27bBrlDpApPsMACkPZQF8gElodUzQYVmnFE2IwlcAUk0HZKjgdKnSwRYDQMzrRLt79BrPMOET6aDmljFXvpz5UG4AnXVffQsXGtVDYk3TdoCBLQCKpdEDELwVtPrvg2yDzf1ZKnxB7LvHMi7DOfHg8tATA1In3MBIC0A9N9RT02EW1WZ3gcCPBlbBRtdtpI0SUHbxvSYIBR5a2GFEGAKAF3YVfkdBhXXBBk86gnRzxIxHCLETOTa40I5z60RmUzsvzFBDAkNR9+BoF0EQkD+ILjX02yDhnVdKBCFYIIE+qKXlT5ZMmohlarg5aQp2KOkmAkZhVnRjl2y26eabcDryWZx01mnnnXhCsmSdgQAAOw==" v:shapes="_x0000_s1741">

属性：

生命周期相关注解

@PostConstruct @PreDestroy

相当于：

' src="data:image/png;base64,R0lGODlhPwMrAHcAMSH+GlNvZnR3YXJlOiBNaWNyb3NvZnQgT2ZmaWNlACH5BAEAAAAALA4AEwCmAQoAhgAAAA0LCggKDQ4LDQ0LCwQIDQ0NEAoLDQsLDQ4LCgMGNA0LNAoLNA0LVwAEVwoLVwMEVw0KdggIdgMGdgADdgAEdgoKdgAEkwAAkw0IkwQAkwMAkwQAsQsGsQAAsQgDsQMDsQMAsQQAzAAAzAoEzAMAzAgDzBAhDRA0CBA0DQ0hCA00BBQhLQ0oWg5GAxBGCxFXCg5XABBXCg5XAxBXABFXCBB3AxBnCBB3ABF3ABBnABFnCBF3BBB3BBF3AxBnBC0OEC0LDi0hFDMzMypZhEMLDUkQEUNvmWMQEXwNDW9CDW9ZWpMODpmZb4SZb5mZmaoQEKoQDgECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwECAwf/gACCg4SFhoeCATYniI2Ohw0iCoYNHAKNQFBBSEyCmZudj4ORIyOToqiGn5yemqyOkaeNsam1s5a1lZeIq6G9orq2wsPEgsGpx4e/AMuOLi+NR01FxYWKjNXVyapRAEa+3d/DJLLZyuHg3qHmlLjsAMnbj/KEQOie9/PuyPvvxPH99O06pw5fQUcBbgw4ROTJEifUsj1ThAJHDhiCCOjIcVGQC445oFG0CO1QhBKlCgw6OeJCQEIGOhlJIiimN5qIFpgoNUKlIHKEOvA8JTSloKI9G9mcWVMmTpMok8LjIAHlJJZSSfAcgeEAog4TRDgQqlJnKQcAtPLsWqmqKUEZ/3j6ZOlyoKGlOPE2oovL7Ai0R+Wm3cpWwwMRf+HK1SkrAwUEh8CKJQvAL1q1pdhStarYKAC+dgvpBTC6UYwUAJ4dagGx2keROHYMULEIQAxoGlEPWsFjQIDYA3gvzGnCZySVGTxcYjGkeXMh2Ug8NgTUUIbCXkdpyC6IufMh0M3pNC7i8fXs40e9LNQBw2EFHSYBTR+vPILzJ5ErPw4g+fLv4Gkjgn6XzFccPNsVUl9XEUDwWQkERrCBVwt8ENog7b0XX1qT0LdPJOYxCGF/+w1I4n/fhVeNCjIM8lohrEUkzIuJ1KbRC7+BFBIAOebQ2zUAqNDDcIek119XU11oDv9/1JVDCldeaQXYT4n5U+SBSX42oSBGZsnlTqVMF18D242J2FBeZinhAY5BNt55afoDpy5PlnKKlITEk+AgbVZ2IFAZoOXXCGIqQOYBZm41CUCXrNnnm0jS884M2Li4oyAxDrMCRyXxaKMOKfymWyI4oCakb7Wd2oiRc+LinXMqDsNkIdXBY+KaGL6V6ySvPseOkcHg6qdPcUZmaJmGmpjnh7g4Oh2kXgXTa4DFtCrArOzpqid3/T17oIQMWNjImMhim2awEz5anLUATBvrMCwasmkOumVazIuiArCCD4zEINsgQAoHpKrEzTViB8pZOYh0kNEqSzBw8jklXBMrDGzgs1sOq56SQR2LqHzTbSzymvmdWDLCHFdzcsIMIxKoMR/uKUjJ/v0EQsXsebxhyyLD3OiENCu3csrVUErIRxgJ0tATTD+hhGs49kADR7ppBBI0H+VQgw48JJDqkKtiCUBRE6wnHpi6chhUKRWYgIEFUSGJFZIKD3Lxz+iJPRiUX+ncIdp3ZnYAul7F5RnZZmeD+CWDXhU3d2phV4jhUn0WAtHkfuwnmntrhnd/go1dStlEE7NC0h51WvfqrLfu+uuwxy776rXObjsABPxA5O289+7778AHTzuhDQvfumqPBAIAOw==" v:shapes="_x0000_s1745">

关于注解和XML的选择问题

###### 注解的优势：

配置简单，维护方便（我们找到类，就相当于找到了对应的配置）。

XML 的优势：

###### 修改时，不用改源码。不涉及重新编译和部署。

Spring 管理 Bean 方式的比较：

## 基于纯注解方式的使用

### 注解和XML混合开发遗留的问题

###### 想一想能不能将以下这些bean的配置都从xml中去掉，并且最终将XML也去掉。如果可以，那么我们就可以脱离xml配置了。

注解扫描配置（能不能去掉）

3 ' src="data:image/png;base64,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" v:shapes="_x0000_s1746">

非自定义的Bean配置（比如：SqlSessionFactory和BasicDataSource配置）

去掉XML后，如何创建ApplicationContext

之前创建ApplicationContext都是通过读取XML文件进行创建的。

@Configuration

属 性 ： value:用于指定配置类的字节码示例代码：

@Bean

标签 2 3 作用为：注册bean对象，主要用来配置非自定义的bean，比如DruidDataSource、SqlSessionFactory 4 5 @Bean标注在方法上(返回某个实例的方法) " src="data:image/png;base64,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" v:shapes="_x0000_s1752">

属性：

###### 示例代码：

@ComponentScan

属性：

###### 示例代码：

Bean类（Service类）：

- @Service
- public class UserServiceImpl implements UserService {
  - @Override
  - public void saveUser() {
    - System.out.println("保存用户 Service实现"); 6 }

7 }

@Configuration @ComponentScan(basePackages="com.kkb.spring.service") public class SpringConfiguration {

public SpringConfiguration() { System.out.println("容器初始化...");

}

1

2

3

4

5

6

7

8

9

10

11

12

13

配置类：

@Bean @Scope("prototype")

public UserService userService() { return new UserServiceImpl(1,"张三");

}

//

//

//

//

//

}

#### @PropertySource

###### 属性

示例代码配置类：

- @Configuration
- @PropertySource("classpath:jdbc.properties")
- public class JdbcConfig {
  - @Value("${jdbc.driver}")
  - private String driver;
  - @Value("${jdbc.url}")
  - private String url;
  - @Value("${jdbc.username}")
  - private String username;
  - @Value("${jdbc.password}")

11

12

13

14

15

16

17

18

19

20

21

22

23

24

25

26

27

28

29

30

31 }

32

private String password;

/**

- 创建一个数据源，并存入 spring 容器中

*

- @return

*/

@Bean(name = "dataSource")

public DataSource createDataSource() { try {

ComboPooledDataSource ds = new ComboPooledDataSource(); ds.setDriverClass(driver);

ds.setJdbcUrl(url); ds.setUser(username); ds.setPassword(password); return ds;

} catch (Exception e) {

throw new RuntimeException(e);

}

}

properties文件：

问题：

#### @Import

标签 2 3 用来组合多个配置类,在引入其他配置类时，可以不用再写@Configuration 注解。当然，写上也没问题。 " src="data:image/png;base64,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" v:shapes="_x0000_s1766">

###### 属性

示例代码：

- @Configuration
- @ComponentScan(basePackages = "com.kkb.spring")
- @Import({ JdbcConfig.class })

4 public class SpringConfiguration { 5 }

6

- @Configuration
- @PropertySource("classpath:jdbc.properties")
- public class JdbcConfig { 10 }

### 创建纯注解方式上下文容器

###### Java应用（AnnotationConfigApplicationContext）

Web应用（AnnotationConfigWebApplicationContext，后面讲解）

2 3 contextClass 4 5 org.springframework.web.context. 6 support.AnnotationConfigWebApplicationContext 7 8 9 10 contextConfigLocation 11 12 com.kkb.spring.test.SpringConfiguration 13 14 15 16 17 org.springframework.web.context.ContextLoaderListener 18 19 20 " src="data:image/png;base64,R0lGODlhPwMEAHcAMSH+GlNvZnR3YXJlOiBNaWNyb3NvZnQgT2ZmaWNlACH5BAEAAAAALAAAAAABAAEAgAAAAAECAwICRAEAOw==" v:shapes="_x0000_s1776">

核心高级篇

AOP介绍

什么是AOP

###### 在软件业，AOP为Aspect Oriented Programming的缩写，意为：面向切面编程

作用：在不修改目标类代码的前提下，可以通过AOP技术去增强目标类的功能。通过【预编译方式】和【运行期动态代理】实现程序功能的统一维护的一种技术 AOP是一种编程范式，隶属于软工范畴，指导开发者如何组织程序结构

AOP最早由AOP联盟的组织提出的,制定了一套规范.Spring将AOP思想引入到框架中,必须遵守AOP联盟的规范AOP是OOP的延续，是软件开发中的一个热点，也是Spring框架中的一个重要内容，是函数式编程的一种衍生范型

利用AOP可以对业务代码中【业务逻辑】和【系统逻辑】进行隔离，从而使得【业务逻辑】和【系统逻辑】之间的耦合度降低，提高程序的可重用性，同时提高了开发的效率。

为什么使用AOP

作用：

###### AOP采取横向抽取机制，补充了传统纵向继承体系（OOP）无法解决的重复性代码优化（性能监视、事务管理、安全检查、缓存），将业务逻辑和系统处理的代码（关闭连接、事务管理、操作日志记录）解耦。

优势：

###### 重复性代码被抽取出来之后，维护更加方便纵向继承体系：

横向抽取机制：

AOP相关术语介绍

术语解释

Joinpoint(连接点)

Pointcut(切入点)

Advice(通知/增强)

Introduction(引介)

Target(目标对象)

1 代理的目标对象

Weaving(织入)

Proxy（代理）

Aspect(切面)

Advisor（通知器、顾问）

##### 图示说明

AOP实现之AspectJ（了解）

###### AspectJ是一个Java实现的AOP框架，它能够对java代码进行AOP编译（一般在编译期进行），让java代码具 有AspectJ的AOP功能（当然需要特殊的编译器）

可以这样说AspectJ是目前实现AOP框架中最成熟，功能最丰富的语言。更幸运的是，AspectJ与java程序完全 兼容，几乎是无缝关联，因此对于有java编程基础的工程师，上手和使用都非常容易。

了解AspectJ应用到java代码的过程（这个过程称为织入），对于织入这个概念，可以简单理解为aspect(切 面)应用到目标函数(类)的过程。

对于织入这个过程，一般分为动态织入和静态织入，动态织入的方式是在运行时动态将要增强的代码织入到目 标类中，这样往往是通过动态代理技术完成的，如Java JDK的动态代理(Proxy，底层通过反射实现)或者CGLIB的动态代理(底层通过继承实现)，Spring AOP采用的就是基于运行时增强的代理技术

ApectJ采用的就是静态织入的方式。ApectJ主要采用的是编译期织入，在这个期间使用AspectJ的acj编译器 (类似javac)把aspect类编译成class字节码后，在java目标类编译时织入，即先编译aspect类再编译目标 类。

AOP实现之Spring AOP(了解)

##### 实现原理分析

###### Spring AOP是通过动态代理技术实现的

而动态代理是基于反射设计的。（关于反射的知识，请自行学习）

动态代理技术的实现方式有两种：基于接口的JDK动态代理和基于继承的CGLib动态代理。

JDK动态代理

###### 目标对象必须实现接口

1 1. 使用Proxy类来生成代理对象的一些代码如下：

2 /**

- \* 使用JDK的方式生成代理对象
- \* @author Administrator

5 */

- public class MyProxyUtils {
- public static UserService getProxy(final UserService service) {
  - // 使用Proxy类生成代理对象
  - UserService proxy =
    - (UserService) Proxy.newProxyInstance(
  - service.getClass().getClassLoader(),
  - service.getClass().getInterfaces(),
- new InvocationHandler() { 14
  - // 代理对象方法一执行，invoke方法就会执行一次
    - public Object invoke(Object proxy, Method method, Object[] args) throws Throwable {
    - if("save".equals(method.getName())){
      - System.out.println("记录日志...");
      - // 开启事务

20 }

- // 提交事务
- // 让service类的save或者update方法正常的执行下去
- return method.invoke(service, args); 24 }

25 });

- // 返回代理对象
  - return proxy; 28 }

29 }

Cglib动态代理

###### 目标对象不需要实现接口

底层是通过继承目标对象产生代理子对象（代理子对象中继承了目标对象的方法，并可以对该方法进行增强）

- 编写相关的代码
  - public static UserService getProxy(){
- // 创建CGLIB核心的类
- Enhancer enhancer = new Enhancer();
- // 设置父类
- enhancer.setSuperclass(UserServiceImpl.class);
- // 设置回调函数
- enhancer.setCallback(new MethodInterceptor() {
  - @Override
  - public Object intercept(Object obj, Method method, Object[] args,
    - MethodProxy methodProxy) throws Throwable {
  - if("save".equals(method.getName())){
    - // 记录日志

14

15 }

System.out.println("记录日志了...");

16

17 }

18 });

return methodProxy.invokeSuper(obj, args);

19

20

21

22 }

23

// 生成代理对象

UserService proxy = (UserService) enhancer.create(); return proxy;

##### 使用

其使用ProxyFactoryBean创建:

使用aop:advisor 定义通知器的方式实现AOP则需要通知类实现Advice接口增强（通知）的类型有：

基于AspectJ的AOP使用

###### 其实就是指的Spring + AspectJ整合，不过Spring已经将AspectJ收录到自身的框架中了，并且底层织入依然是采取的动态织入方式。

添加依赖

org.springframeworkspring-aspects5.0.7.RELEASEaopallianceaopalliance1.0 " src="data:image/png;base64,R0lGODlhgQEEAHcAMSH+GlNvZnR3YXJlOiBNaWNyb3NvZnQgT2ZmaWNlACH5BAEAAAAALAAAAAABAAEAgAAAAAECAwICRAEAOw==" v:shapes="_x0000_s1799">

编写目标类和目标方法

编写接口和实现类（目标对象）

1 UserService接口2

3 UserServiceImpl实现类

###### 配置目标类，将目标类交给spring IoC容器管理

' src="data:image/png;base64,R0lGODlhPwMEAHcAMSH+GlNvZnR3YXJlOiBNaWNyb3NvZnQgT2ZmaWNlACH5BAEAAAAALAAAAAABAAEAgAAAAAECAwICRAEAOw==" v:shapes="_x0000_s1800">

使用XML实现

##### 实现步骤

编写通知（增强类，一个普通的类）

配置通知，将通知类交给spring IoC容器管理

配置AOP 切面

##### 切入点表达式

###### 切入点表达式的格式：

表 达 式 格 式 说 明 ： execution：必须要修饰符：可省略

返回值类型：必须要，但是可以使用*通配符包 名 ：

类名

方法名：

参数：

通知类型

通知类型（五种）：前置通知、后置通知、最终通知、环绕通知、异常抛出通知。 前置通知：

- \* 执行时机：目标对象方法之前执行通知
- \* 配置文件：<aop:before method="before" pointcut-ref="myPointcut"/>
- \* 应用场景：方法开始时可以进行校验

###### 后置通知：

最终通知：

\* 应用场景：例如像释放资源 ' src="data:image/png;base64,R0lGODlhNAIEAHcAMSH+GlNvZnR3YXJlOiBNaWNyb3NvZnQgT2ZmaWNlACH5BAEAAAAALAAAAAABAAEAgAAAAAECAwICRAEAOw==" v:shapes="_x0000_s1816">

环绕通知：

\* 应用场景：事务、统计代码执行时机 ' src="data:image/png;base64,R0lGODlhRQIEAHcAMSH+GlNvZnR3YXJlOiBNaWNyb3NvZnQgT2ZmaWNlACH5BAEAAAAALAAAAAABAAEAgAAAAAECAwICRAEAOw==" v:shapes="_x0000_s1818">

异常抛出通知：

3 * 应用场景：包装异常 ' src="data:image/png;base64,R0lGODlhPwMEAHcAMSH+GlNvZnR3YXJlOiBNaWNyb3NvZnQgT2ZmaWNlACH5BAEAAAAALAAAAAABAAEAgAAAAAECAwICRAEAOw==" v:shapes="_x0000_s1819">

使用注解实现

实现步骤

编写切面类（注意不是通知类，因为该类中可以指定切入点）

配置切面类

' src="data:image/png;base64,R0lGODlhPwMEAHcAMSH+GlNvZnR3YXJlOiBNaWNyb3NvZnQgT2ZmaWNlACH5BAEAAAAALAAAAAABAAEAgAAAAAECAwICRAEAOw==" v:shapes="_x0000_s1820">

开启AOP自动代理

环绕通知注解配置

@Around

定义通用切入点

使用@PointCut注解在切面类中定义一个通用的切入点，其他通知可以引用该切入点

纯注解方式

组件支撑篇

整合Junit

### 单元测试问题

###### 在测试类中，每个测试方法都有以下两行代码：

我们使用单元测试要测试的是业务问题，以上两段代码明显不是业务代码。

但是这两行代码的作用是获取容器，如果不写的话，直接会提示空指针异常，所以又不能轻易删掉。

解决思路分析

针对上述问题，我们需要的是程序能自动帮我们创建容器。一旦程序能自动为我们创建 spring 容器，我们就无须手动创建了，问题也就解决了。

但紧接的问题就是junit它本身不认识spring，更无法帮助创建Spring容器了，不过好在Junit 给我们暴露了一个注解（@RunWith），可以让我们替换掉它的运行器。

这时，我们需要依靠 spring 框架，因为它提供了一个运行器，可以读取配置文件（或注解）来创建容器。我们只需要告诉它配置文件在哪就行了。

具体实现

第一步：添加依赖

第二步：通过@RunWith注解，指定spring的运行器

第三步：通过@ContextConfiguration注解，指定spring运行器需要的配置文件路径 第四步：通过@Autowired注解给测试类中的变量注入数据

事务支持事务回顾事务介绍

###### 事务：指的是逻辑上一组操作，组成这个事务的各个执行单元，要么一起成功,要么一起失败！

事务的特性（ACID）：

原子性（Atomicity）

一致性（Consistency）

1 一致性是指事务必须使数据库从一个一致性状态变换到另一个一致性状态，也就是说一个事务执行之前和执行之后都必 须处于一致性状态。

2

3 拿转账来说，假设用户A和用户B两者的钱加起来一共是5000，那么不管A和B之间如何转账，转几次账，事务结束后两 个用户的钱相加起来应该还得是5000，这就是事务的一致性。

隔离性（Isolation）

###### 持久性（Durability）

事务并发问题（隔离性导致）

在事务的并发操作中可能会出现一些问题：

脏读：一个事务读取到另一个事务未提交的数据。

不可重复读：一个事务因读取到另一个事务已提交的数据。导致对同一条记录读取两次以上的结果不一致。

update操作

幻读：一个事务因读取到另一个事务已提交的数据。导致对同一张表读取两次以上的结果不一致。insert、delete操作

事务隔离级别

###### 为了避免上面出现的几种情况，在标准SQL规范中，定义了4个事务隔离级别，不同的隔离级别对事务的处理不同

四种隔离级别：

现在来看看MySQL数据库为我们提供的四种隔离级别（由低到高）：

① Read uncommitted (读未提交)：最低级别，任何情况都无法保证。

② Read committed (读已提交)：可避免脏读的发生。

③ Repeatable read (可重复读)：可避免脏读、不可重复读的发生。

④ Serializable (串行化)：可避免脏读、不可重复读、幻读的发生。

默认隔离级别

大多数数据库的默认隔离级别是Read Committed（RC），比如Oracle、DB2等。MySQL数据库的默认隔离级别是Repeatable Read（RR）。

注意事项：

对于多数应用程序，可以优先考虑把数据库系统的隔离级别设为Read Committed。它能够避免脏读取，而且具有较好的并发性能。尽管它会导致不可重复读、幻读这些并发问题，在可能出现这类问题的个别场合，可以由应用程序采 用悲观锁或乐观锁来控制。

Spring框架事务管理相关接口

1. PlatformTransactionManager接口 -- 平台事务管理器.(真正管理事务的类)。该接口有具体的实现类，根据不同的持久层框架，需要选择不同的实现类！

###### 2. TransactionDefinition接口 -- 事务定义信息.(事务的隔离级别,传播行为,超时,只读)

1. TransactionStatus接口 -- 事务的状态（是否新事务、是否已提交、是否有保存点、是否回滚）
2. 总结：上述对象之间的关系：平台事务管理器真正管理事务对象.根据事务定义的信息TransactionDefinition 进行事务管理，在管理事务中产生一些状态.将状态记录到TransactionStatus中
3. 接口的实现类

- 如果使用的Spring的JDBC模板或者MyBatis（IBatis）框架，需要选择DataSourceTransactionManager 实现类
- 如果使用的是Hibernate的框架，需要选择HibernateTransactionManager实现类

- PlatformTransactionManager接口中实现类和常用的方法

1. 该接口的常用方法

- void commit(TransactionStatus status)
- TransactionStatus getTransaction(TransactionDefinition definition)
- void rollback(TransactionStatus status)

1

2

3

4

5

6

7

8

9

- TransactionDefinition
- \* static int ISOLATION_READ_UNCOMMITTED
- \* static int ISOLATION_READ_COMMITTED
- \* static int ISOLATION_REPEATABLE_READ
- \* static int ISOLATION_SERIALIZABLE 7
- 事务的传播行为常量（不用设置，使用默认值）
  - \* 先解释什么是事务的传播行为：解决的是业务层之间的方法调用！！
    - \* PROPAGATION_REQUIRED（默认值） -- A中有事务,使用A中的事务.如果没有，B就会开启一个新的事务,将A包含进来.(保证A,B在同一个事务中)，默认值！！
      - \* PROPAGATION_SUPPORTS -- A中有事务,使用A中的事务.如果A中没有事务.那么B也不使用事务.
    - \* PROPAGATION_MANDATORY -- A中有事务,使用A中的事务.如果A没有事务.抛出异常.

13

- \* PROPAGATION_REQUIRES_NEW -- A中有事务,将A中的事务挂起.B创建一个新的事务.(保证A,B没有在一个事务中)
- \* PROPAGATION_NOT_SUPPORTED -- A中有事务,将A中的事务挂起.
- \* PROPAGATION_NEVER -- A中有事务,抛出异常.

17

18 * PROPAGATION_NESTED -- 嵌套事务.当A执行之后,就会在这个位置设置一个保存点. 如果B没有问题.执行通过.如果B出现异常,运行客户根据需求回滚(选择回滚到保存点或者是最初始状态)

19

Spring框架事务管理的分类

###### 1. Spring的编程式事务管理（不推荐使用）

1. Spring的声明式事务管理（底层采用AOP的技术）

编程式事务管理（了解）

说明：Spring为了简化事务管理的代码:提供了模板类 TransactionTemplate，所以手动编程的方式来管理事务， 只需要使用该模板类即可！！

手动编程方式的具体步骤如下：

1. 步骤一:配置一个事务管理器，Spring使用PlatformTransactionManager接口来管理事务，所以咱们需要使 用到他的实现类！！

- <!-- 配置事务管理器 -->

2

- \* 5

###### 2. 步骤二:配置事务管理的模板

3 4 ' src="data:image/png;base64,R0lGODlhPwMEAHcAMSH+GlNvZnR3YXJlOiBNaWNyb3NvZnQgT2ZmaWNlACH5BAEAAAAALAAAAAABAAEAgAAAAAECAwICRAEAOw==" v:shapes="_x0000_s1855">

1. 步骤三:在需要进行事务管理的类中,注入事务管理的模板

' src="data:image/png;base64,R0lGODlhpAIEAHcAMSH+GlNvZnR3YXJlOiBNaWNyb3NvZnQgT2ZmaWNlACH5BAEAAAAALAAAAAABAAEAgAAAAAECAwICRAEAOw==" v:shapes="_x0000_s1857">

1. 步骤四:在业务层使用模板管理事务:

}

});

}

声明式事务管理（重点）

声明式事务管理又分成三种种方式

基于AspectJ的XML方式（重点掌握）

基于AspectJ的注解+XML混用方式（重点掌握） 基于AspectJ的纯注解方式（重点掌握）

事务管理之XML方式

###### 准备转账环境：

业务层

持久层

spring配置

##### 单元测试代码

配置事务管理的AOP

###### 平台事务管理器：DataSourceTransactionManager

事务通知：

" src="data:image/png;base64,R0lGODlhPwMEAHcAMSH+GlNvZnR3YXJlOiBNaWNyb3NvZnQgT2ZmaWNlACH5BAEAAAAALAAAAAABAAEAgAAAAAECAwICRAEAOw==" v:shapes="_x0000_s1868">

AOP配置：

事务管理之混合方式

service类上或者方法上加注解：

开启事务注解：

事务管理之基于AspectJ的纯注解方式